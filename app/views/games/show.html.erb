<p>
  <h3>Title: <%= @game.title %></h3>
  
</p>
 
<p>
  <h3>Link: <%= @game.link %></h3>
  
</p>

<h3>
  <div class="simple-calendar">
    <%= month_calendar events: @rentals do |date, rentals| %>
      <%= link_to date, new_rental_path(date: date, game_id: @game.id) %>
      <% game_rentals = {}
         rentals.each do |rental|
           game_rentals[rental.game_id] = rental
         end %>
      <div>
        <%= if !game_rentals[@game.id].nil?
        	    link_to game_rentals[@game.id].user.email, game_rentals[@game.id]
        	  end %>
      </div>
    <% end %>
  </div>
</h3>
<h4>
<% if user_signed_in? && current_user.is_admin == 1 %>
  <td><%= link_to 'Edit', edit_game_path(@game) %></td>
  <td><%= link_to 'Destroy', game_path(@game),
          method: :delete,
          data: { confirm: 'Are you sure?' } %></td>
<% end %>
<td><%= link_to 'Back to games list', games_path %></td>
</h4>

<p id="notice"><%= notice %></p>

<h1>Rentals</h1>

<table  class="table table-striped table-bordered table-hover">
  <thead>
    <tr>
      <th>Name</th>
      <th>Start time</th>
      <th>End time</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @rentals.each do |rental| %>
	    <% if @game.id == rental.game_id %>
	      <tr>
	        <td><%= rental.name %></td>
	        <td><%= rental.start_time %></td>
	        <td><%= rental.end_time %></td>
	        <td><%= link_to 'Show', rental %></td>
          <% if rental.user == current_user %>
  	        <td><%= link_to 'Edit', edit_rental_path(rental) %></td>
  	        <td><%= link_to 'Destroy', rental, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <% end %>
	      </tr>
	    <% end %>
	<% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Rental', new_rental_path %>


</div>
